<view class="bookings-page">
  <scroll-view
    class="booking-list"
    scroll-y="{{true}}"
    bindscrolltolower="onLoadMore"
    refresher-enabled="{{true}}"
    refresher-triggered="{{isRefreshing}}"
    refresher-background="#f5f5f5"
    bindrefresherrefresh="onRefresh"
  >
    <view class="list-content" wx:if="{{bookings.length > 0}}">
      <view class="booking-card" wx:for="{{bookings}}" wx:key="_id">
        <view class="header">
          <view class="worker">
            <image class="avatar" src="{{item.workerAvatar || '/images/default-avatar.png'}}" mode="aspectFill" />
            <view class="meta">
              <text class="name">{{item.workerName || 'é˜¿å§¨'}}</text>
              <text class="time">æäº¤äº {{item.createdAtText}}</text>
            </view>
          </view>
          <text class="status">{{item.statusText}}</text>
        </view>

        <view class="detail-row" wx:if="{{item.serviceType}}">
          <text class="label">æœåŠ¡ç±»å‹</text>
          <text class="value">{{item.serviceTypeText}}</text>
        </view>
        <view class="detail-row" wx:if="{{item.startDate}}">
          <text class="label">å¼€å§‹æ—¶é—´</text>
          <text class="value">{{item.startDate}}</text>
        </view>
        <view class="detail-row" wx:if="{{item.duration}}">
          <text class="label">æœåŠ¡æ—¶é•¿</text>
          <text class="value">{{item.duration}}</text>
        </view>
        <view class="detail-row" wx:if="{{item.address}}">
          <text class="label">æœåŠ¡åœ°å€</text>
          <text class="value address">{{item.address}}</text>
        </view>
        <view class="detail-row" wx:if="{{item.totalPrice}}">
          <text class="label">é¢„ç®—é‡‘é¢</text>
          <text class="value price">Â¥{{item.totalPrice}}</text>
        </view>

        <view class="actions" wx:if="{{item.status === 'pending' || item.status === 'confirmed'}}">
          <button class="btn-cancel" data-booking-id="{{item._id}}" bindtap="onCancelBooking">å–æ¶ˆé¢„çº¦</button>
        </view>
      </view>
    </view>

    <view class="load-status">
      <loading wx:if="{{isLoading}}" type="spinner" text="åŠ è½½ä¸­..." />
      <text class="no-more" wx:if="{{!hasMore && bookings.length > 0}}">æ²¡æœ‰æ›´å¤šäº†</text>
    </view>

    <view class="empty-state" wx:if="{{!isLoading && bookings.length === 0}}">
      <text class="empty-icon">ğŸ—‚ï¸</text>
      <text class="empty-text">æš‚æ— é¢„çº¦è®°å½•</text>
      <button class="btn-go" bindtap="onGoWorkers">å»é¢„çº¦</button>
    </view>
  </scroll-view>
</view>
